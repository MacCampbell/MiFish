Title:
Analytical pipeline for DNA sequences amplified by MiFish primers to provide species-assignment and the read count table.

Description:
The MiFish pipeline works on the Linux/Unix environment. In the first step, the pipeline conducts quality-filtering of the MiFish sequence reads, including Phred score-based low-quality tail-trimming, length filtering, deletion of N base-containing reads, paired-end read assembly, and primer sequences removal. The fasta files of the reads that passed through these quality check are generated. As the next step, the pipeline performs sequence similarity-based species-assignment and the generation of a species by read-count table. This tab-spaced table provides species diversity information detected from the MiFish PCR meta-barcoding analysis of environmental DNAs. 

To run the pipeline, make directories and their subdirectories having a structured arrangement as follows:

/MiFish_pipeline
	/BlastDB
	/MiFish_RunXX
		/data
		/scripts
	/Parsers
	/Tools

In the subdirectory "/MiFish_pipeline/BlastDB," put Blastn database files (*.nhr, *.nin, and *.nsq) to be used in the analysis. For example, "complete_partial_mitogenomes.nhr," "complete_partial_mitogenomes.nin," and "complete_partial_mitogenomes.nsq" made based on the MitoFish database (Iwasaki et al. Mol Biol Evol. 2013, 30: 2531-2540) should be placed in this subdirectory.

In the subdirectory "/MiFish_pipeline/MiFish_RunXX/data," put the fastq.gz files (Illumina MiSeq or HiSeq output) to be analyzed.

In the subdirectory "/MiFish_pipeline/MiFish_RunXX/scripts," shell script files, which have extensions "*.sh" attached here, should be placed.

In the subdirectory "/MiFish_pipeline/Parsers," the script files named "allsamples_nameprinter_v1.pl", "allsamples_species.counter_v2.pl", "blastres_parse_counter_v4.pl", "blastres_parser_LODs_v2.pl", "blastres_parser_v5.pl", "size_extracter_def.pl", "uc_size_fas_integrator.pl," and "uc_size_processor.pl" attached here should be placed.

In the subdirectory "/MiFish_pipeline/Tools," the script files named "check_seq_length_MiFish.pl" and "Fastq_Nread_trim.pl" attached here should be placed. The software directory "FastQC" (http://www.bioinformatics.babraham.ac.uk/projects/fastqc/), "FLASH-[version.number]" (Magoc and Salzberg. Bioinformatics. 2011, 27: 2957-2963), "ncbi-blast-[version.number]" (Camacho et al. BMC Bioinformatics. 2009, 10: 421) should also be placed here. The directory name of the software FLASH and ncbi-blast should be specified in line 19 of the shell script named "J03_PE_read_assembly.sh." and line 20 of the shell script named "J11_Blastn.sh," respectively. The perl scripts "DynamicTrim.pl" (Cox et al. BMC Bioinformatics. 2010, 11: 485) and "tagcleaner.pl" (Schmieder et al. BMC Bioinformatics. 2010, 11: 341) should be placed. The software binary of "usearch[version.number]_i86linux32" (Edgar Bioinformatics. 2010, 26: 2460-2461) should be placed here. The version name of the software "usearch" should be specified in line 6 of the shell script named "J10_Uclust_derep_trim.sh."

To run the pipeline, use the following commands:

$ cd ./MiFish_pipeline/MiFish_RunXX/scripts
$ ./A01_Preprocessing_startar.sh
$ ./A02_SpeciesAssignment_starter.sh

Input:
DNA sequences in fastq format generated by the Illumina platform DNA sequencers. The sequences should be paired-ended that cover a target region of the MiFish primers.

Output:
DNA sequences in fasta format that passed through the MiFish quality-check pipeline placed in the subdirectory "MiFish_pipeline/MiFish_RunXX/1_6_Primer_removed/results."  A species by read-count table based on the sequence-similarity analysis placed in the subdirectory "MiFish_pipeline/MiFish_RunXX/4_2_Allsamples_speciescnt_table."
